var fs = require('fs');

module.exports = {
    get: function(rootDir, cb) {
        var ignoreList = ['bower_components', 'node_modules', 'dist', 'package.json', 'npm-debug.log', 'CVS', 'config.gypi', 'package-lock.json', 'config.xml'];

        fs.readdir(rootDir, function(err, contents) {
            var dirs = [];
            var files = [];
            for (var index = 0; index < contents.length; ++index) {
                var item = contents[index];
                var itemPath = rootDir + '/' + item;
                fs.stat(itemPath, function(err, stat) {
                    if (this.item[0] !== '.' && ignoreList.indexOf(this.item) == -1) {
                        if (stat.isDirectory()) {
                            dirs.push(this.item);
                        } else {
                            files.push(this.item);
                        }
                    }
                    if (contents.length === (this.index + 1)) {
                        return cb(dirs, files);
                    }
                }.bind({ index: index, item: item }));
            }
        });
    }
}